# 🎟️ 빠른 매진 랭킹 기능

## ✅ 기능

- **전체 콘서트의 빠른 매진 랭킹 매기기**
    - 매진 시간: `티켓 오픈 시각` - `좌석이 모두 결제 완료된 시각` (초 단위)
    - 모든 좌석이 결제 완료 상태일 때만 매진으로 간주
    - 최초 매진만 측정 (취소 후 재매진은 제외)
- **상위 N개 빠른 매진 랭킹 조회**

---

## 🛠️ 구현

- **결제 완료 시 이벤트 기반 비동기 처리 흐름**
<pre>
[결제 완료]
   ↓
[Event 발행 (AfterCommit)]
   ↓
[매진 여부 판단]
   ↓
[중복 여부 Redis 확인 및 저장 (SETNX)]
   ↓
[ZSET 등록 (랭킹)]
</pre>
- 매진일 경우:
    - Redis 에 콘서트 식별자를 `SETNX`로 저장하여 중복 방지
    - Redis `ZSET`에 `콘서트 ID`를 값으로, `매진 시간`을 score로 저장
- Redis `ZRANGE` 명령어로 Top N 조회

---

## 🔍 회고

### 📚 배운 점

- Redis ZSET을 이용한 랭킹 구현 방식을 실제로 적용해보며, score 기반 정렬과 조회 흐름 익힘
- Redis가 단순 캐시가 아닌 **핵심 데이터 저장소**로서도 사용될 수 있다는 점을 체감
- Redis를 메인 흐름에 도입할 경우 **고가용성**의 중요함을 깨달음

---

### 😵 어려웠던 점
- 비동기 이벤트 테스트를 위한 `Awaitility`를 처음 사용하여, 폴링 간격, 최대 대기 시간 등을 조절하는 방법을 학습

---

### 🔄 확장 포인트

- 랭킹 기능을 카테고리/지역 기준으로 확장하여 **사용자 맞춤 랭킹 서비스**로 발전 가능
